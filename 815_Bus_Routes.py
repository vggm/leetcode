
INF = 999999999


class Solution:

  def __init__(self) -> None:
    self.routes : list[list[int]]
    self.source : int
    self.target : int
    
    self.ady_mat : list[list[int]]
    self.stops : dict[int,int]
    self.num_of_vertices : int
    

  def print_mat ( self ) -> None:
    m = self.ady_mat
    print('-- Adyacency Matrix --')
    for row in m:
      for value in row:
        data = value if value != INF else 'N'
        print(f"{data} ", end='')
      print()
    print('-- ### <--  --> ### --')
  

  def generate_stops ( self ) -> None:
    stops = {}
    
    count = 0
    for route in self.routes:
      for stop in route:
        if stops.get(stop) is None:
          stops[stop] = count
          count += 1
    
    print(stops)
    self.stops = stops
    self.num_of_vertices = len(stops)


  def generate_adyacency_matrix ( self ) -> bool:
    n = self.num_of_vertices
    m = [ [ INF if i != j else 0 for j in range(n) ] for i in range(n) ]
    # exists = [False, False]
    
    # for route in self.routes:
    #   for i, current_stop in enumerate(route):
    #     if i == len(route) - 1:
    #       if current_stop == route[0]:
    #         continue
    #       else:
    #         next_stop = route[0]
    #     else:
    #       next_stop = route[i+1]
          
    #     m[ self.stops[ current_stop ] ][ self.stops[ next_stop ] ] = 1
    #     m[ self.stops[ next_stop ] ][ self.stops[ current_stop ] ] = 1
    
    for route in self.routes:
      
    
    self.ady_mat = m
    return False
    
    
  def dijkstra ( self, source: int ) -> list[int]:

    def min_distance ( distance: list[int], visited: list[bool] ) -> int:
      minimum = INF
      min_index = -1
      
      for v in self.stops.values():
        if distance[v] < minimum and not visited[v]:
          minimum = distance[v]
          min_index = v
      
      return min_index

    distance = [INF] * self.num_of_vertices
    distance[ self.stops[source] ] = 0
    visited = [False] * self.num_of_vertices
    
    for _ in self.stops.values():
      u = min_distance ( distance, visited )
      
      if u == -1:
        break
      
      visited[u] = True
      
      for v in self.stops.values():
        if self.ady_mat[u][v] > 0 \
          and not visited[v] \
          and distance[v] > distance[u] + self.ady_mat[u][v]:
            distance[v] = distance[u] + self.ady_mat[u][v]
    
    return distance
    

  def num_buses_to_destination ( self, routes: list[list[int]], source: int, target: int ) -> int:
    
    if source == target:
      return 0
    
    self.routes = routes
    self.source = source
    self.target = target
    
    if (self.generate_stops()):
      return self.ans
      
    self.generate_adyacency_matrix()
    self.print_mat()
    
    distance = self.dijkstra( source )
    self.ans = distance[self.stops[target]]
    return self.ans if self.ans != INF else -1
  


if __name__ == '__main__':
  
  solution = Solution()
  
  
  sol = solution.num_buses_to_destination (
    routes = [[1,2,7,3]], source = 1, target = 7
  )
  
  res = '0. Yes' if sol == 1 else '0. No'
  print(sol)
  print(res)
  
  
  # sol = solution.num_buses_to_destination (
  #   routes = [[1,2,7],[3,6,7]], source = 1, target = 6
  # )
  
  # res = '1. Yes' if sol == 2 else '1. No'
  # print(sol)
  # print(res)
  
  
  sol = solution.num_buses_to_destination (
    routes = [[7,12],[4,5,15],[6],[15,19],[9,12,13]], source = 15, target = 12
  )
  
  # res = '2. Yes' if sol == -1 else '2. No'
  # print(sol)
  # print(res)
  
  
  # sol = solution.num_buses_to_destination (
  #   routes = [[24],[3,6,11,14,22],[1,23,24],[0,6,14],[1,3,8,11,20]], source = 20, target = 8
  # )
  
  # res = '3. Yes' if sol == 1 else '3. No'
  # print(sol)
  # print(res)
  
  
  # sol = solution.num_buses_to_destination (
  #   routes = [[9,17,26,28,61,86,87,95,132,134,137,166,222,227,240,246,248,280,283,286,295,304,327,336,348,365,370,373,377,403,422,425],[3,6,11,18,25,41,53,89,91,97,101,124,132,190,197,203,210,211,218,244,248,258,270,273,278,291,306,314,321,325,330,335,343,345,350,365,373,380,381,398,408,416,435],[19,48,56,65,79,100,132,135,147,152,158,173,187,193,214,222,227,242,248,298,306,338,354,356,376,399,412,440,451],[2,9,14,30,33,48,50,52,60,69,72,74,75,76,80,88,90,91,93,94,102,103,104,107,111,113,119,122,124,133,134,136,145,154,181,195,204,205,208,214,216,219,226,227,232,236,238,242,246,251,255,265,320,327,332,337,338,345,348,352,357,365,372,386,392,399,401,403,418,427,429,432,441,442,453],[2,5,12,47,92,104,122,123,127,130,136,143,167,172,177,196,199,205,211,221,240,259,262,267,269,271,304,320,324,337,347,353,358,368,373,376,382,429,432,446,450,453],[22,34,57,65,69,91,105,121,135,139,143,165,187,225,226,229,236,245,248,256,276,286,298,309,327,329,337,390,412],[3,7,8,21,32,45,46,55,59,61,63,68,69,70,77,82,84,89,91,99,116,133,163,164,174,175,186,191,194,210,217,219,225,234,235,238,242,243,248,260,268,275,291,294,297,305,322,334,336,366,370,379,386,391,399,404,420,424,432,451],[4,9,10,16,19,37,38,39,52,75,89,93,101,113,116,117,119,125,129,136,137,167,170,172,186,190,192,197,205,206,212,215,217,221,236,245,248,253,258,260,289,293,294,304,306,313,314,323,326,331,344,375,377,400,407,409,422,424,433,447,449],[2,3,66,72,90,113,161,248,284,288,289,298,331,332,343,349,371,395,427,432,437,454],[4,7,32,38,40,53,56,58,64,65,70,78,89,99,101,104,116,121,126,156,158,159,167,178,183,219,228,235,237,251,259,278,280,281,309,312,336,337,340,356,359,374,377,382,383,397,404,415,424,434,451,452],[1,5,7,18,23,25,32,38,39,47,58,59,63,71,73,78,90,94,97,101,105,117,118,148,152,156,159,164,170,180,186,189,194,196,217,219,225,246,251,253,256,257,281,293,304,322,328,349,360,370,372,374,377,385,391,393,403,416,431,450],[1,13,20,64,90,105,112,119,133,159,187,197,204,225,232,249,271,277,287,291,304,318,320,329,346,356,360,373,382,391,401,403,404,405,414,417,423,433,434,437,439,449,451],[43,74,153,199],[47,111,186,195,215,232,297,321,354],[12,34,127,164,187,230,335,344,367,435],[6,8,48,95,108,131,137,202,203,261,296,298,318,323,324,326,331,347,354,380,389,396,409,437],[26,31,52,64,79,92,99,122,128,133,135,140,168,169,179,199,206,212,214,218,236,261,286,293,295,323,338,341,350,374,376,410,414,424,449],[0,1,14,36,38,42,44,52,55,61,62,63,69,71,74,82,84,88,93,96,103,108,117,126,131,153,159,163,174,188,202,213,214,237,238,280,284,285,287,292,297,310,318,327,344,360,361,376,379,386,415,416,417,425,438,439,451],[11,13,17,26,30,34,60,62,72,73,104,120,130,135,142,154,156,173,183,188,198,221,225,274,279,302,309,310,311,322,341,348,351,359,369,386,391,392,398,405,408,416,439],[1,3,23,32,51,55,56,58,62,64,66,67,68,69,74,93,98,103,104,107,115,116,125,126,127,139,142,148,150,154,157,158,167,170,176,190,193,199,200,204,207,223,227,230,241,246,248,255,263,267,270,274,275,280,282,299,303,306,323,326,339,342,346,347,356,357,358,360,361,374,379,390,399,415,418,422,425,432,437,444,452],[32,49,98,125,333,334,381],[2,47,51,70,97,99,114,117,120,237,258,262,305,313,344,352,394,397,430],[3,5,20,22,25,28,31,32,39,43,54,56,57,60,61,66,71,73,94,95,101,102,107,114,140,144,160,162,168,174,175,182,195,198,217,230,248,257,261,264,269,284,288,289,292,301,311,319,324,328,334,336,340,346,349,360,363,368,372,386,399,407,417,422,430,442,445,446,451,452],[6,12,30,43,58,59,62,67,68,69,73,99,103,106,111,112,118,126,127,140,163,193,213,232,235,243,253,258,262,278,281,285,290,291,297,309,313,328,341,349,351,354,374,379,386,393,402,417,432,439,444],[4,10,36,43,54,61,88,91,107,120,123,126,159,167,179,276,281,282,307,308,323,341,347,404,449],[13,30,39,45,49,62,77,78,89,126,132,142,167,173,178,185,196,204,206,210,217,220,222,236,239,245,249,260,263,266,270,275,279,280,281,302,306,308,316,321,338,358,368,372,380,410,424,427,445],[3,5,8,26,37,54,56,74,89,102,112,121,123,126,137,139,151,152,153,158,163,173,196,199,209,242,266,281,288,294,297,309,315,316,332,348,357,359,360,372,396,397,400,401,406,427,428,435,453,454],[3,27,32,43,55,63,87,95,101,120,144,150,154,209,241,261,282,303,344,351,361,379,432,437,450],[18,40,54,70,85,89,114,150,161,174,177,178,185,192,206,213,225,239,248,271,279,287,310,320,332,350,361,362,380,394,403,408,427,432,442,448],[12,18,19,36,37,44,70,79,80,81,87,89,100,101,113,128,130,133,144,149,151,155,158,168,170,182,206,224,234,238,242,244,247,253,257,264,276,287,292,311,331,346,349,350,352,358,359,362,371,372,374,377,380,382,384,396,397,399,402,407,413,416,419,423,424,426,427,432,434,438,445,446,452],[5,13,17,21,28,32,55,60,64,67,70,76,88,91,99,111,121,122,125,129,135,138,140,143,144,147,154,157,158,164,181,200,201,225,231,234,236,245,247,257,258,259,261,277,285,287,288,303,316,329,340,341,348,363,387,388,398,399,402,405,415,424,426],[14,27,40,43,75,96,100,114,117,118,121,127,133,155,161,169,182,185,186,202,210,224,239,240,254,257,259,276,277,283,285,287,290,294,315,324,331,342,343,346,349,351,352,361,365,377,382,384,386,391,405,410,423,431],[62,89,117,239,311,329,368],[14,26,73,76,85,90,101,145,154,156,166,179,187,201,208,211,222,296,304,357,358,359,405,412,431],[11,21,22,23,33,39,40,45,59,60,61,91,102,108,113,131,163,172,173,185,191,205,208,219,221,222,235,240,246,258,259,261,262,263,265,267,280,283,285,286,287,292,298,304,305,308,324,328,331,333,334,340,365,368,377,380,393,399,405,407,430,431,433,435,440,446,449],[1,9,38,40,41,48,50,58,69,89,91,113,123,124,130,132,136,141,158,159,165,174,179,183,210,213,220,222,230,251,263,270,291,297,322,324,333,341,347,352,365,367,377,380,398,400,407,428,437,448],[6,70,76,89,95,98,104,117,127,128,134,142,144,145,152,161,162,165,178,181,186,193,195,200,213,214,216,233,235,255,261,267,273,274,280,283,289,297,300,304,307,324,338,360,377,381,394,396,406,416,420,421,423,427,428,431,433,442,443,445,446,449,454],[9,10,13,14,17,34,37,39,50,58,60,63,79,87,92,103,126,140,145,148,166,171,177,178,197,198,202,208,220,224,229,233,266,268,270,284,292,297,303,307,319,324,334,335,358,374,385,388,400,401,403,412,417,419,429,440,443,452],[15,18,31,32,35,41,66,69,76,93,104,114,117,120,124,125,135,137,145,149,157,169,193,196,203,204,222,224,227,236,242,243,249,253,268,269,283,296,314,316,317,321,322,325,339,340,349,363,364,387,388,400,401,403,405,410,412,413,415,423,435,445,446,452],[12,13,18,24,28,43,46,48,52,66,72,79,85,86,103,105,113,126,142,145,149,151,155,157,158,173,180,181,184,185,188,191,202,210,213,222,223,229,242,247,249,250,264,274,277,298,299,309,337,340,344,345,362,370,377,382,383,408,421,435,441,445],[10,27,69,96,104,112,113,146,152,164,166,176,178,179,199,216,230,268,276,297,307,308,314,319,320,351,369,371,378,409,413,431,436],[134,183,185,221,444],[20,32,50,63,73,159,173,221,262,271,285,302,323,327,339,384,454],[75,197,229,409],[6,13,16,20,21,22,32,40,87,92,104,128,154,158,160,162,175,177,184,194,198,203,210,212,217,220,221,225,231,240,246,258,266,280,295,297,298,299,303,318,334,355,362,372,382,390,394,398,410,413],[15,31,76,79,82,89,93,110,115,125,136,167,175,179,193,233,237,239,252,261,263,266,302,308,319,321,326,327,331,347,382,386,388,393,394,396,398,399,410,412,423,429,431,451],[25,28,35,36,59,63,140,143,150,169,174,188,191,205,206,222,223,228,249,259,263,273,285,318,330,333,335,342,344,357,376,399,416,441,443],[4,5,15,30,66,70,72,73,80,94,95,97,99,123,126,135,139,142,152,153,154,166,171,180,212,219,228,230,232,235,245,267,270,273,290,296,321,323,334,338,350,355,374,392,399,400,406,411,416,421,422,425,431,447,453],[0,32,52,91,146,159,209,210,212,216,263,285,287,288,289,296,302,304,306,312,317,380],[42,58,63,66,68,80,82,83,87,91,110,125,141,154,159,179,180,182,183,186,189,208,221,225,239,244,246,258,264,312,324,342,348,371,385,396,428],[0,4,6,10,19,28,50,59,60,72,88,94,132,138,146,150,159,201,218,222,237,255,259,300,340,347,384,388,415,421,439,443,446,453],[16,23,29,35,84,94,98,103,105,111,125,132,142,152,158,166,167,176,186,188,192,198,202,211,214,219,225,226,229,239,244,245,275,281,282,303,314,327,328,342,349,356,357,361,373,379,381,382,396,399,409,414,434,437,444,448],[5,7,17,29,31,32,57,67,68,82,83,88,95,105,106,115,120,128,133,155,160,167,185,188,196,207,215,225,228,240,254,264,277,288,296,297,306,313,322,325,332,336,338,340,345,361,382,414,422,424,436],[41,60,65,138,157,216,233,283,319,377,422,434,445,451],[44,46,48,54,55,63,72,75,81,84,94,108,110,133,137,141,147,155,160,178,180,185,190,199,206,214,217,221,227,235,237,240,247,258,262,271,276,279,283,284,285,289,292,295,297,299,313,319,323,329,335,354,362,367,376,392,393,409,411,422,424,435,436],[6,8,10,15,17,21,40,47,60,65,68,69,82,86,92,95,99,109,110,117,137,146,147,154,155,158,165,171,177,178,192,195,201,202,203,207,213,242,248,249,253,270,272,284,289,295,306,318,326,334,335,337,342,343,361,364,377,386,395,400,404,425,441,442,443,452,453,454],[2,10,38,51,62,81,85,109,149,164,176,199,218,263,359,361,371,377,383,387,395,415],[0,21,53,122,132,143,165,166,201,203,228,255,282,283,296,304,311,317,318,339,358,388,398,405,428,439],[20,79,301,339,354,394,414,429],[7,16,33,36,56,67,73,88,91,95,97,116,119,121,126,127,129,131,156,163,169,191,210,214,227,233,242,278,284,297,319,326,338,352,366,388,414,415,420,427,428,437,438,447,452],[0,1,25,48,77,165,175,193,202,211,213,217,258,261,278,307,309,312,316,333,366,382,385,416,425],[2,14,58,97,102,110,124,127,150,153,165,166,167,169,172,184,185,190,220,237,242,252,257,259,290,296,301,308,338,343,375,378,379,388,396,397,411,434,451],[3,18,20,28,31,35,43,45,55,57,63,65,68,71,74,77,82,85,88,91,94,96,114,121,122,147,170,172,182,186,189,191,199,205,207,210,217,219,223,232,233,235,236,237,238,239,246,256,258,269,270,278,279,286,287,294,298,301,325,327,331,333,339,349,357,364,368,375,377,378,383,386,387,397,398,405,428,438,440,443],[3,6,29,33,49,70,71,99,118,119,124,133,142,148,155,165,177,191,202,243,268,271,280,283,287,298,301,321,342,350,357,364,370,373,385,407],[11,15,17,22,30,51,54,62,64,74,75,89,98,99,101,108,110,113,125,129,131,134,136,146,161,162,165,168,171,177,190,206,213,216,233,239,241,258,267,271,295,297,306,315,317,327,335,337,348,374,375,383,389,393,395,400,401,411,412,416,423,438,446],[19,68,126,134,169,194,225,424],[17,20,32,34,63,68,80,83,87,90,100,102,107,109,120,130,177,226,229,255,266,276,280,294,296,297,303,307,319,325,327,353,376,398,404,405,410,422,428,453],[7,13,16,25,29,31,33,34,36,47,49,74,100,120,124,144,147,153,161,163,168,173,176,197,202,214,216,231,238,239,241,244,248,253,262,263,274,278,292,295,296,345,355,358,369,380,381,383,391,412,415,416,421,433,441,444,448],[0,1,2,17,41,47,69,70,73,80,90,109,111,113,130,133,138,145,155,178,181,187,191,200,218,221,223,230,234,235,241,252,255,260,261,265,284,287,299,304,310,317,318,320,325,327,329,330,340,353,365,387,394,401,409,423,427,429,441,446,452],[4,9,19,20,26,41,70,80,113,117,120,139,151,153,199,237,243,247,257,260,263,279,283,287,297,321,344,356,383,442],[14,34,67,96,107,111,113,118,122,136,144,187,198,214,253,270,319,347,358,371,383,430,432,449,451],[13,55,65,73,86,94,99,102,115,120,130,142,147,161,180,187,189,208,224,231,268,276,281,290,294,302,309,322,326,327,330,331,338,341,343,356,362,367,369,374,375,396,401,402,410,417,424,425,438,444,446,450],[23,37,57,69,83,104,143,145,190,236,276,320,332,341,345,348,354,427],[185,332,392],[0,4,11,13,17,18,24,28,31,34,42,43,51,55,58,60,64,67,68,72,78,80,91,94,98,117,118,123,124,130,135,136,137,142,157,160,183,185,188,191,195,197,210,213,218,220,231,233,238,248,250,252,258,265,272,275,289,298,308,320,321,327,338,341,366,376,379,380,385,393,397,401,414,427,433,443,452],[30,49,69,104,132,247,273,386,389],[1,4,14,15,33,42,67,83,104,117,120,128,129,133,150,152,158,168,171,193,196,208,210,224,237,254,255,275,285,294,305,306,334,338,358,380,384,398,411,430,432,434,437,444,448],[10,53,105,160,288,320,356,402],[11,13,30,34,43,47,48,53,55,58,62,68,72,81,87,96,106,110,111,116,117,122,124,127,128,136,138,140,146,157,161,164,168,174,176,181,185,190,200,204,230,233,235,245,250,262,265,266,279,280,282,285,288,291,292,308,333,341,343,360,364,366,373,374,375,377,386,389,391,394,398,399,404,412,424,428,449],[9,10,12,19,30,52,60,63,66,71,73,77,83,84,85,91,98,107,115,117,122,125,135,157,160,172,174,181,193,205,209,232,244,246,249,250,252,257,258,262,269,279,280,282,289,291,314,317,318,326,332,348,353,354,359,383,386,387,389,391,407,412,415,425,426,432,439,440,443,444,445],[34,67,435,454],[10,11,19,29,30,33,42,44,50,60,63,64,65,66,87,99,101,103,118,125,126,135,136,137,141,155,158,159,170,171,180,184,191,195,216,218,222,224,226,241,248,250,254,263,268,287,299,300,304,316,318,337,354,357,367,371,374,375,383,387,388,390,393,395,399,400,427,433,434,444],[7,16,30,31,37,44,47,55,71,84,90,93,96,121,128,129,138,140,141,166,167,181,188,215,218,222,224,229,235,240,242,249,250,254,268,276,296,299,306,319,335,340,349,350,351,355,357,358,398,406,409,416,430,433,435,449],[3,27,29,46,51,54,60,61,69,77,82,88,92,98,106,107,124,128,146,163,166,170,182,189,212,217,218,228,229,232,270,278,281,283,293,294,301,305,312,320,322,325,333,341,346,352,354,373,382,389,401,404,418,420,421,422,428,446,448],[4,19,31,39,109,138,154,183,228,249,266,275,294,336,338,343,350,360,371,379,386,402,404,409],[48,368],[168,188,235,324,428],[7,10,11,34,36,37,39,43,49,58,62,70,78,80,83,89,98,100,104,106,109,111,114,118,120,130,133,144,146,147,149,157,168,172,176,178,185,186,189,193,195,202,203,215,225,226,230,234,238,240,247,259,274,282,295,296,298,300,305,309,314,319,329,340,357,360,366,380,394,395,399,408,416,421,427,440,443,450],[2,6,7,20,26,30,38,49,56,62,69,71,73,76,83,84,85,87,94,133,134,144,149,159,164,170,174,180,181,187,196,214,217,223,224,226,233,241,255,257,261,265,283,285,288,296,303,320,337,339,341,346,351,361,388,390,410,417,430,440,451,453],[21,32,46,47,53,55,59,87,119,122,137,138,146,147,151,183,199,203,214,229,232,233,242,264,286,296,316,319,345,347,360,365,373,375,388,396,407,409,417,425,428,431,446,454],[10,21,40,48,71,73,75,78,81,97,99,103,113,116,131,166,189,202,236,274,275,291,309,320,357,360,390,410,417,444,445,446,450]],
  #   source = 69,
  #   target= 41
  # )
  
  # print(sol)